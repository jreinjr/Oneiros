{% extends "base.html" %}

{% block title %}3D Graph Visualization - Oneiros{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
<script src="https://unpkg.com/3d-force-graph"></script>
<script src="https://unpkg.com/neo4j-driver"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/TextPlugin.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrambleTextPlugin.min.js"></script>
{% endblock %}

{% block content %}
<div class="main-content">
    <div id="graph-container" class="theme-beauty">
        <div id="3d-graph"></div>
        
        <svg id="connection-line">
            <path class="connection-path" d=""></path>
        </svg>
        
        <div id="node-popup">
            <div id="node-popup-title">Selected Node</div>
            <div id="node-popup-name"></div>
        </div>
        
        <div id="controls-panel">
            <div class="panel-header">
                <h3 class="panel-title">Controls</h3>
                <button class="minimize-btn" id="minimizeBtn">âˆ’</button>
            </div>
            <div class="control-group">
                <h3>Graph Configuration</h3>
                <div class="control-item">
                    <label>Number of Nodes</label>
                    <div class="slider-container">
                        <input type="range" id="nodeCount" min="10" max="500" value="100">
                        <span class="value-display" id="nodeCountValue">100</span>
                    </div>
                </div>
                <div class="control-item">
                    <label>Connection Density</label>
                    <div class="slider-container">
                        <input type="range" id="connectionDensity" min="0.01" max="1.0" step="0.01" value="0.3">
                        <span class="value-display" id="connectionDensityValue">0.3</span>
                    </div>
                </div>
                <div class="control-item">
                    <label>Node Size</label>
                    <div class="slider-container">
                        <input type="range" id="nodeSize" min="1" max="10" step="0.5" value="2">
                        <span class="value-display" id="nodeSizeValue">2</span>
                    </div>
                </div>
                <div class="control-item">
                    <label>Node Distance</label>
                    <div class="slider-container">
                        <input type="range" id="nodeDistance" min="50" max="1500" step="10" value="200">
                        <span class="value-display" id="nodeDistanceValue">200</span>
                    </div>
                </div>
                <div class="theme-toggle">
                    <button class="theme-btn truth" data-theme="truth">Truth</button>
                    <button class="theme-btn beauty active" data-theme="beauty">Beauty</button>
                    <button class="theme-btn love" data-theme="love">Love</button>
                </div>
                <button id="regenerateGraph">Generate Random Graph</button>
                <button id="generateBeliefGraph">Generate Belief Graph</button>
            </div>

            <div class="control-group">
                <h3>Highlighting Controls</h3>
                <div class="control-item">
                    <label>Default Connection Thickness</label>
                    <div class="slider-container">
                        <input type="range" id="connectionThickness" min="0.5" max="5" step="0.5" value="1">
                        <span class="value-display" id="connectionThicknessValue">1</span>
                    </div>
                </div>
                <div class="control-item">
                    <label>Highlight Steps</label>
                    <div class="slider-container">
                        <input type="range" id="highlightSteps" min="0" max="5" step="1" value="1">
                        <span class="value-display" id="highlightStepsValue">1</span>
                    </div>
                </div>
            </div>

            <div class="control-group">
                <h3>Camera Controls</h3>
                <div class="control-item">
                    <label>Orbit Speed</label>
                    <div class="slider-container">
                        <input type="range" id="orbitSpeed" min="0.01" max="1.0" step="0.01" value="0.1">
                        <span class="value-display" id="orbitSpeedValue">0.1</span>
                    </div>
                </div>
                <div class="control-item">
                    <label>Focus Duration (seconds)</label>
                    <div class="slider-container">
                        <input type="range" id="focusDuration" min="2" max="20" value="8">
                        <span class="value-display" id="focusDurationValue">8</span>
                    </div>
                </div>
                <div class="control-item">
                    <label>Transition Speed (ms)</label>
                    <div class="slider-container">
                        <input type="range" id="transitionSpeed" min="500" max="4000" step="100" value="2000">
                        <span class="value-display" id="transitionSpeedValue">2000</span>
                    </div>
                </div>
                <div class="control-item">
                    <label>Orbit Distance</label>
                    <div class="slider-container">
                        <input type="range" id="orbitDistance" min="50" max="3000" value="120">
                        <span class="value-display" id="orbitDistanceValue">120</span>
                    </div>
                </div>
                <button id="toggleOrbit">
                    <span class="status-indicator status-inactive" id="orbitStatus"></span>
                    Start Auto-Orbit
                </button>
                <button id="resetCamera">Reset Camera</button>
            </div>
        </div>

        <div id="poetry-log">
            <div id="log-entries"></div>
            <div class="log-title">Poetry Log</div>
        </div>
    </div>
</div>

<script type="module" src="{{ url_for('static', filename='js/main.js') }}"></script>
{% endblock %}